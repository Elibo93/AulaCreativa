
-- 1. Creaci贸n de la tabla PROFESORES
CREATE TABLE PROFESORES (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,

    nombre VARCHAR(255) NOT NULL,
    apellido VARCHAR(255) NOT NULL,
    especialidad VARCHAR(255),
    email VARCHAR(255) NOT NULL UNIQUE,
    telefono VARCHAR(20),
    created_at TIMESTAMP NOT NULL
);

-- 2. Creaci贸n de la tabla TALLERES
CREATE TABLE TALLERES (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,

    nombre VARCHAR(255) NOT NULL,
    descripcion VARCHAR(1000),

    id_profesor BIGINT NOT NULL,  -- FK -> PROFESORES(id)

    hora_inicio VARCHAR(10),
    hora_fin VARCHAR(10),  
    aforo_maximo INTEGER,

    CONSTRAINT fk_taller_profesor FOREIGN KEY (id_profesor)
      REFERENCES PROFESORES(id)
      ON DELETE RESTRICT
);

-- 3. Creaci贸n de la tabla ALUMNOS
CREATE TABLE ALUMNOS (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,

    dni VARCHAR(10) NOT NULL,   
    nombre VARCHAR(255) NOT NULL,
    apellido VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL UNIQUE,
    telefono VARCHAR(20),
    direccion VARCHAR(500),
    fecha_nacimiento VARCHAR(20),
    created_at TIMESTAMP NOT NULL   -- LocalDateTime
);

-- 4. Creaci贸n de la tabla INSCRIPCIONES
CREATE TABLE INSCRIPCIONES (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,

    id_alumno BIGINT NOT NULL,    -- FK -> ALUMNOS(id)
    id_taller BIGINT NOT NULL,    -- FK -> TALLERES(id)
    created_at TIMESTAMP NOT NULL,

    CONSTRAINT fk_inscripcion_alumno FOREIGN KEY (id_alumno)
      REFERENCES ALUMNOS(id)
      ON DELETE CASCADE,

    CONSTRAINT fk_inscripcion_taller FOREIGN KEY (id_taller)
      REFERENCES TALLERES(id)
      ON DELETE RESTRICT
);

-- 5. Secuencia opcional (para H2 o PostgreSQL si lo necesitas)
DROP SEQUENCE IF EXISTS ALUMNOS_SEQ;
CREATE SEQUENCE ALUMNOS_SEQ START WITH 100 INCREMENT BY 1;

DROP SEQUENCE IF EXISTS PROFESORES_SEQ;
CREATE SEQUENCE PROFESORES_SEQ START WITH 100 INCREMENT BY 1;

DROP SEQUENCE IF EXISTS TALLERES_SEQ;
CREATE SEQUENCE TALLERES_SEQ START WITH 100 INCREMENT BY 1;

DROP SEQUENCE IF EXISTS INSCRIPCIONES_SEQ;
CREATE SEQUENCE INSCRIPCIONES_SEQ START WITH 100 INCREMENT BY 1;
